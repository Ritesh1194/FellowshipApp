package com.bridgelabz.registration;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

import org.omg.CORBA.CurrentOperations;


public class CustomerDAOImpl implements CustomerDAO {

	static Connection connection;
	ConnectionProvider conProb = new ConnectionProvider();
	static PreparedStatement preparedStatement;

	@Override
	public int insertCustomer(Customer customer) {
		int status = 0;
		try {
			System.out.println(customer.getName()+ "vicky");
			connection = conProb.dbConnection();
			
			System.out.println(connection + "Connection");
			
			preparedStatement = connection
					.prepareStatement("insert into customer(username,password,name) values(?,?,?)");
			System.out.println(preparedStatement + "Kilogram");
			preparedStatement.setString(1, customer.getUsername());
			preparedStatement.setString(2, customer.getPassword());
			preparedStatement.setString(3, customer.getName());
			status = preparedStatement.executeUpdate();

			connection.close();
		} catch (Exception e) {
			e.printStackTrace();
		}
		return status;
	}

	@Override
	public Customer getCustomer(String username, String password) {
		Customer customer = new Customer();
		
		try {
			connection = conProb.dbConnection();
			preparedStatement = connection.prepareStatement("select * from customer where username =? and password=?");
			System.out.println(preparedStatement+" bikashs");
			preparedStatement.setString(1, username);
			preparedStatement.setString(2, password);

			ResultSet result = preparedStatement.executeQuery();
			while (result.next()) {
				customer.setUsername(result.getString(1));
				customer.setPassword(result.getString(2));
				customer.setName(result.getString(3));
			}
		} catch (Exception e) {
			e.printStackTrace();
		}
		return customer;
	}
}